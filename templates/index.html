<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ABB Product Search</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo-section">
                    <h1 class="logo">
                        <i class="fas fa-search"></i>
                        ABB Product Search
                    </h1>
                </div>
                <div class="stats-section">
                    <div class="stat-item">
                        <span class="stat-label">Model</span>
                        <span class="stat-value">Fast Search</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-label">Accuracy</span>
                        <span class="stat-value">99.7%</span>
                    </div>
                    <a href="/training" class="training-btn" title="Manage Training Data">
                        <i class="fas fa-database"></i>
                        <span>Training Data</span>
                    </a>
                </div>
            </div>
        </header>

        <!-- Tab Navigation -->
        <section class="tab-section">
            <div class="tab-container">
                <div class="tab-nav">
                    <button class="tab-btn active" data-tab="search">
                        <i class="fas fa-search"></i>
                        Single Search
                    </button>
                    <button class="tab-btn" data-tab="bulk">
                        <i class="fas fa-file-excel"></i>
                        Bulk Processing
                    </button>
                </div>
                
                <!-- Single Search Tab Content -->
                <div class="tab-content active" id="searchTab">
                    <div class="search-container">
                        <div class="search-box">
                            <i class="fas fa-search search-icon"></i>
                            <input 
                                type="text" 
                                id="searchInput" 
                                placeholder="Search for ABB products... (e.g., 'ACB 800A 4P', 'MCCB 100A', 'contactor 20A')"
                                autocomplete="off"
                            >
                            <button id="searchBtn" class="search-btn">
                                <span class="btn-text">Search</span>
                                <i class="fas fa-spinner fa-spin btn-spinner" style="display: none;"></i>
                            </button>
                        </div>
                        
                        <div class="search-options">
                            <label class="option-item">
                                <span>Results:</span>
                                <select id="resultsCount">
                                    <option value="5" selected>5</option>
                                    <option value="10">10</option>
                                    <option value="15">15</option>
                                    <option value="20">20</option>
                                </select>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Bulk Processing Tab Content -->
                <div class="tab-content" id="bulkTab">
                    <div class="excel-container">
                        <div class="excel-header">
                            <h2>
                                <i class="fas fa-file-excel"></i>
                                Bulk Excel Processing
                            </h2>
                            <p>Upload an Excel file with "Customer Query" columns to get automatic product matches</p>
                        </div>
                        
                        <div class="excel-upload-area" id="excelUploadArea">
                            <div class="upload-content">
                                <i class="fas fa-cloud-upload-alt upload-icon"></i>
                                <h3>Drop your Excel file here</h3>
                                <p>or <button class="browse-btn" onclick="document.getElementById('excelFileInput').click()">browse files</button></p>
                                <div class="file-info">
                                    <small>Supports .xlsx and .xls files. Looks for "Customer Query" columns and adds Order Code, Description, and Match Info columns to the right.</small>
                                </div>
                            </div>
                            <input type="file" id="excelFileInput" accept=".xlsx,.xls" style="display: none;">
                            <div class="selected-file" id="selectedFile" style="display: none;">
                                <i class="fas fa-file-excel"></i>
                                <span class="file-name" id="fileName"></span>
                                <button class="remove-file" onclick="clearSelectedFile()">×</button>
                            </div>
                        </div>
                        
                        <div class="excel-actions">
                            <button class="process-btn" id="processBtn" onclick="processExcel()" disabled>
                                <i class="fas fa-cogs"></i>
                                <span class="btn-text">Process Excel</span>
                                <i class="fas fa-spinner fa-spin btn-spinner" style="display: none;"></i>
                            </button>
                            <div class="excel-status" id="excelStatus"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Results Section -->
        <section class="results-section" id="resultsSection" style="display: none;">
            <div class="results-header">
                <h2 class="results-title">
                    <i class="fas fa-list-ul"></i>
                    Search Results
                </h2>
                <div class="results-meta" id="resultsMeta"></div>
            </div>
            
            <!-- Results Tab Navigation -->
            <div class="results-tab-nav" id="resultsTabNav">
                <button class="results-tab-btn active" data-tab="training">
                    <i class="fas fa-star"></i>
                    Training Matches
                    <span class="tab-count" id="trainingCount">0</span>
                </button>
                <button class="results-tab-btn" data-tab="catalog">
                    <i class="fas fa-database"></i>
                    Catalog Matches
                    <span class="tab-count" id="catalogCount">0</span>
                </button>
            </div>
            
            <!-- Training Results Tab -->
            <div class="results-tab-content active" id="trainingResults">
                <div class="results-container" id="resultsContainer">
                    <!-- Training results will be populated here -->
                </div>
            </div>
            
            <!-- Catalog Results Tab -->
            <div class="results-tab-content" id="catalogResults">
                <div class="results-container" id="catalogContainer">
                    <!-- Catalog results will be populated here -->
                </div>
            </div>
        </section>

        <!-- Empty State -->
        <section class="empty-state" id="emptyState">
            <div class="empty-content">
                <i class="fas fa-search empty-icon"></i>
                <h3>Start Your Product Search</h3>
                <p>Enter a product name, model number, or specifications to find ABB products.</p>
                <div class="example-queries">
                    <span class="example-label">Try these examples:</span>
                    <div class="example-items">
                        <button class="example-btn" data-query="ACB 800A 4P">ACB 800A 4P</button>
                        <button class="example-btn" data-query="MCCB 100A">MCCB 100A</button>
                        <button class="example-btn" data-query="contactor 20A">contactor 20A</button>
                        <button class="example-btn" data-query="isolator 4P 63A">isolator 4P 63A</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Error Section -->
        <section class="error-section" id="errorSection" style="display: none;">
            <div class="error-content">
                <i class="fas fa-exclamation-triangle error-icon"></i>
                <h3>Search Error</h3>
                <p id="errorMessage">An error occurred while searching. Please try again.</p>
                <button class="retry-btn" onclick="clearError()">
                    <i class="fas fa-redo"></i>
                    Try Again
                </button>
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2024 ABB Product Search Interface. Built with ❤️ for better product discovery.</p>
        </div>
    </footer>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
</body>
</html>